import{j as p,B as h}from"./mui-Cw0dwOiN.js";import{r as L}from"./reactVendor-BTcQ-GDs.js";import{u as j}from"./lang-cE5BfbQy.js";import{u as m,ab as B,p as P,x as k,aF as M,bS as O,bx as w,by as A,a5 as g,bR as F,a7 as U}from"./react-setup-B6u61idX.js";import{b as _}from"./base-DriPzto9.js";import"./load-functions-AabybIo1.js";import{u as q}from"./router-DEI8QtBD.js";const y=({data:a,companyId:t,parentId:n})=>a.filter(r=>t?r.companyId===t:n?r.parentCompanyId===n:r.parentCompanyId===null||r.parentCompanyId===0).map(r=>({...r,children:y({data:a,parentId:r.companyId})})),b=a=>{let t=[];return t.push({companyId:a.companyId,companyName:a.companyName,parentCompanyId:a.parentCompanyId,parentCompanyName:a.parentCompanyName,channelFlag:a.channelFlag}),a.children&&a.children.length>0&&a.children.forEach(n=>{t=t.concat(b(n))}),t};function Y({open:a=!1,handleClose:t,currentRow:n,companyHierarchyAllList:r,title:I,context:x,dialogParams:C={}}){const l=j(),u=q(),{id:o}=m(({company:e})=>e.companyInfo),{pagesSubsidiariesPermission:f}=m(({company:e})=>e),{isHasCurrentPagePermission:S,companyHierarchyAllList:N}=m(({company:e})=>e.companyHierarchyInfo),[H,d]=L.useState(!1),D=async()=>{if(n)try{d(!0);const e=k.get("cartId"),{companyId:i}=n;if(!i)return;if(i===Number(o)?await M():i&&await O(Number(i)),e){const E=w(e);await A(E),g.dispatch(F(0))}const c=i===Number(o)?"":i,s=r||N;g.dispatch(U({selectCompanyHierarchyId:c,...r&&{companyHierarchyAllList:r},companyHierarchySelectSubsidiariesList:b(y({data:s,companyId:i})[0])}))}catch(e){_.error(e)}finally{d(!1),t()}};return p.jsx(B,{isOpen:a,rightSizeBtn:l("global.button.next"),title:I||l("companyHierarchy.dialog.title"),fullWidth:!0,loading:H,handleLeftClick:t,handRightClick:D,restDialogParams:{TransitionProps:{onExited:()=>{if(!n)return;const{companyId:e}=n;if(e===Number(o)){const{hash:i}=window.location;i.includes("/shoppingList/")&&u("/shoppingLists")}if(e!==Number(o)&&!S){const i=Object.keys(f).find(s=>!!f[s]),c=P.find(s=>s.key===i);c&&(t(),d(!1),u(c.path))}}}},dialogSx:{"& .MuiDialogTitle-root":{border:0},"& .MuiDialogActions-root":{border:0}},...C,children:p.jsx(h,{sx:{maxHeight:"600px"},children:p.jsx(h,{sx:{display:"flex",flexDirection:"column",flex:1},children:x||l("companyHierarchy.dialog.content")})})})}export{Y as H,y as b};
//# sourceMappingURL=HierarchyDialog-8ffGhwnV.js.map
