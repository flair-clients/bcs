System.register(["./mui-legacy-nJi-LPwx.js","./reactVendor-legacy-CtYIj4Ma.js","./form-legacy-CAo5v63e.js","./lang-legacy-BZ1lZp4I.js","./lodashEs-legacy-CZW16S6G.js","./react-setup-legacy-DjnQrG6U.js","./B3CustomForm-legacy-DPyFojA8.js","./load-functions-legacy-Bi-Vku98.js","./base-legacy-BAe6cWtL.js","./users-legacy-BJZU8FS4.js","./config-legacy-F3NV_K8L.js","./validatorRules-legacy-CTb2-K1i.js","./router-legacy-s4T0V6vG.js","./intl-legacy-B7uNycgM.js","./eCache-legacy-CW-H9Ud9.js","./redux-legacy-D5ZHjMNV.js","./toolkit-legacy-uWyLsHZ1.js","../index-legacy.BFKCpyw1.js","./global-legacy-B1EgakWG.js","./muiIcon-legacy-CbXEHT38.js","./dateFns-legacy-Bs-ooDPO.js","./dropzone-legacy-C0uLCPXC.js"],(function(e,a){"use strict";var n,t,o,l,s,i,r,m,d,c,u,f,p,g,y,b,h,w,F,S,N,_,j,x,v,I,M,C;return{setters:[e=>{n=e.j,t=e.B},e=>{o=e.r},e=>{l=e.u},e=>{s=e.u},e=>{i=e.t},e=>{r=e.B,m=e.ac,d=e.j,c=e.C,u=e.a,f=e.ad,p=e.a8,g=e.ae,y=e.k,b=e.u,h=e.t,w=e.af,F=e.ag,S=e.X,N=e.ah},e=>{_=e.B},null,null,e=>{j=e.c,x=e.a},e=>{v=e.d,I=e.g},e=>{M=e.v},e=>{C=e.u},null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(){const{isBCUser:e,companyId:a,customer:r,validateEmailValue:m,emailValidation:M,passwordValidation:E}=function(){const e=b(h),a=b((({company:e})=>e.companyInfo.id)),n=b((({company:e})=>e.customer)),t=b((({company:e})=>e.customer.role)),o=b((({b2bFeatures:e})=>e.masqueradeCompany.id)),l=b((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),s=Number(3===t&&l?o:a),r=!e||3===t&&!l,m=async e=>{if(n.emailAddress===i(e))return!0;const a={email:e,channelId:N},{isValid:t}=r?await j(a):await x(a);return t},d=e=>!(e.email!==n.emailAddress&&!e.currentPassword),c=e=>e.password===e.confirmPassword;return{isBCUser:r,companyId:s,customer:n,validateEmailValue:m,emailValidation:d,passwordValidation:c}}(),{control:P,handleSubmit:R,getValues:J,formState:{errors:$},setValue:D,setError:H}=l({mode:"onSubmit"}),[X,Y]=d("sf-isFinishUpdate",!1,sessionStorage),{state:{portalStyle:{backgroundColor:Z="#FEF9F5"}}}=o.useContext(c),G=s(),[K]=u(),Q=C(),[W,ee]=o.useState([]),[ae,ne]=o.useState([]),[te,oe]=o.useState([]),[le,se]=o.useState(!1),[ie,re]=o.useState({}),[me,de]=o.useState(!1);o.useEffect((()=>{(async()=>{try{se(!0);const n=e?k:q,t=e?{}:{companyId:a},o=e?"customerAccountSettings":"accountSettings",l=await w(e?1:2),s=I(l.accountFormFields||[]),i=(s?.contactInformation||[]).filter((e=>"field_email_marketing_newsletter"!==e.fieldId)),{additionalInformation:r=[]}=s,{[o]:m}=await n(t),d=e?O(m,i,r):A(m,i,L(),r),c=T(),u=[...d,...c],f=u.find((e=>"role"===e.name));f?.fieldType&&(f.fieldType="text"),ee(u),re(m),ne(i),oe(r)}finally{X&&(F.success(G("accountSettings.notification.detailsUpdated")),Y(!1)),se(!1),de(!0)}})()}),[]);const ce=o.useMemo((()=>{const e={field_first_name:G("accountSettings.form.firstName"),field_last_name:G("accountSettings.form.lastName"),field_email:G("accountSettings.form.email"),field_phone_number:G("accountSettings.form.phoneNumber"),field_company:G("accountSettings.form.company"),field_role:G("accountSettings.form.role"),field_current_password:G("accountSettings.form.currentPassword"),field_password:G("accountSettings.form.password"),field_confirm_password:G("accountSettings.form.confirmPassword")};return W.map((a=>({...a,label:e[a.fieldId??""]??a.label})))}),[W,G]);return n.jsx(f,{isSpinning:le,background:Z,children:n.jsxs(t,{sx:{width:K?"100%":"35%",minHeight:K?"800px":"300px","& input, & .MuiFormControl-root .MuiTextField-root, & .MuiSelect-select.MuiSelect-filled, & .MuiTextField-root .MuiInputBase-multiline":{bgcolor:p("#FFFFFF",.87),borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"},"& .MuiButtonBase-root.MuiCheckbox-root:not(.Mui-checked), & .MuiRadio-root:not(.Mui-checked)":{color:p(y(Z),.6)},"& .MuiTypography-root.MuiTypography-body1.MuiFormControlLabel-label, & .MuiFormControl-root .MuiFormLabel-root:not(.Mui-focused)":{color:p(y(Z),.87)},"& .MuiInputLabel-root.MuiInputLabel-formControl:not(.Mui-focused)":{color:p(y("#FFFFFF"),.6)}},children:[n.jsx(_,{formFields:ce,errors:$,control:P,getValues:J,setValue:D}),n.jsx(g,{sx:{mt:"28px",mb:K?"20px":"0",width:"100%",visibility:me?"visible":"hidden"},onClick:()=>{R((async n=>{se(!0);try{const t=await m(n.email);t||H("email",{type:"custom",message:G("accountSettings.notification.emailExists")});const o=M(n);o||F.error(G("accountSettings.notification.updateEmailPassword"));const l=E(n);if(l||(H("confirmPassword",{type:"manual",message:G("global.registerComplete.passwordMatchPrompt")}),H("password",{type:"manual",message:G("global.registerComplete.passwordMatchPrompt")})),t&&o&&l){const t=(e?U:z)(n,ie,ae,te);if(t&&(e||(t.companyId=a,t.extraFields=((e,a)=>a.filter((e=>e.custom&&1===e.groupId)).map((a=>({fieldName:v(a?.name||""),fieldValue:e[a.name]}))))(n,W)),""===t.newPassword&&""===t.confirmPassword&&(delete t.newPassword,delete t.confirmPassword)),!t)return void F.success(G("accountSettings.notification.noEdits"));const o=e?V:B;await o(t),n.password&&n.currentPassword||r.emailAddress!==i(n.email)?Q("/login?loginFlag=loggedOutLogin"):(S.clear(),Y(!0),window.location.reload())}}finally{se(!1)}}))()},variant:"contained",children:G("accountSettings.button.saveUpdates")})]})})}));const a=e=>`mutation{\n  updateAccountSettings (\n    updateData: ${m(e)}\n  ){\n    result {\n      email\n    },\n  }\n}`,E=e=>`mutation{\n  updateCustomerAccountSettings (\n    updateData: ${m(e)}\n  ){\n    result {\n      email\n    },\n  }\n}`,P=e=>`{\n  accountSettings (\n    companyId: ${e.companyId}\n  ){\n    firstName,\n    lastName,\n    company,\n    phoneNumber,\n    email,\n    formFields {\n      name,\n      value\n    },\n    extraFields {\n      fieldName,\n      fieldValue,\n    }\n    role,\n    companyRoleId,\n    companyRoleName,\n  }\n}`,B=e=>r.graphqlB2B({query:a(e)}),V=e=>r.graphqlB2B({query:E(e)}),q=e=>r.graphqlB2B({query:P(e)}),k=()=>r.graphqlB2B({query:"{\n  customerAccountSettings {\n    firstName,\n    lastName,\n    company,\n    phoneNumber,\n    email,\n    formFields {\n      name,\n      value\n    },\n  }\n}"}),L=()=>[{name:"company",fieldId:"field_company",label:"Company",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"role",fieldId:"field_role",label:"Role",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"}],T=()=>[{name:"currentPassword",fieldId:"field_current_password",label:"Current Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"password",fieldId:"field_password",label:"Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"confirmPassword",fieldId:"field_confirm_password",label:"Confirm Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"}],R=M(["email"]),A=(e,a,n,t)=>{const o=e?.extraFields||[];return a.forEach((a=>{const n=a;"first_name"===v(a?.name||"")&&(n.default=e.firstName),"last_name"===v(a?.name||"")&&(n.default=e.lastName),"phone"===v(a?.name||"")&&(n.default=e.phoneNumber),"email"===v(a?.name||"")&&(n.default=e.email,n.validate=R)})),o.length>0&&o.forEach((e=>{const n=e,t=a.find((e=>v(e?.name||"")===n.fieldName));t&&(t.default=n.fieldValue)})),n.forEach((a=>{const n=a;"role"===a.name?(n.default=e.companyRoleName,n.disabled=!0):"company"===a.name&&(n.default=e.company,n.disabled=!0)})),t.forEach((a=>{const n=(e?.formFields||[]).find((e=>e.name===a.bcLabel));n&&(a.default=n.value)})),[...a,...n,...t]},O=(e,a,n)=>(a.forEach((a=>{const n=a;"first_name"===v(a?.name||"")&&(n.default=e.firstName),"last_name"===v(a?.name||"")&&(n.default=e.lastName),"phone"===v(a?.name||"")&&(n.default=e.phoneNumber),"email"===v(a?.name||"")&&(n.default=e.email,n.validate=R),"company"===v(a?.name||"")&&(n.default=e.company)})),n.forEach((a=>{const n=(e?.formFields||[]).find((e=>e.name===a.bcLabel));n&&(a.default=n.value)})),[...a,...n]),z=(e,a,n,t)=>{const o=a?.extraFields||[],l={formFields:[]};let s=!0,i=!0,r=!1;if(Object.keys(e).forEach((m=>{n.forEach((n=>{if(m===n.name&&(i=!1,"first_name"===v(n.name)&&(a.firstName!==e[n.name]&&(s=!1),l.firstName=e[n.name]),"last_name"===v(n.name)&&(a.lastName!==e[n.name]&&(s=!1),l.lastName=e[n.name]),"phone"===v(n.name)&&(a.phoneNumber!==e[n.name]&&(s=!1),l.phoneNumber=e[n.name]),"email"===v(n.name)&&(a.email!==e[n.name]&&(s=!1),l.email=e[n.name]),n.custom)){const a=o.find((e=>e.fieldName===v(n?.name||"")));a?.fieldValue!==e[n.name]&&(r=!0)}})),r&&(s=!1),i&&t.forEach((n=>{if(n.fieldId===m&&l?.formFields){const{name:t}=n;l.formFields.push({name:n?.bcLabel||"",value:e[m]}),i=!1;const o=(a?.formFields||[]).find((e=>e.name===n.bcLabel));o&&JSON.stringify(o.value)!==JSON.stringify(e[m])&&(s=!1),!a?.formFields?.length&&t&&e[t]&&(s=!1)}})),i&&("password"===m?(l.newPassword=e[m],e[m]&&(s=!1)):l[m]=e[m]),i=!0})),delete l.company,delete l.role,!s)return l},U=(e,a,n,t)=>{const o={formFields:[]};let l=!0,s=!0;if(Object.keys(e).forEach((i=>{n.forEach((n=>{i===n.name&&(s=!1,"first_name"===v(n.name)&&(a.firstName!==e[n.name]&&(l=!1),o.firstName=e[n.name]),"last_name"===v(n.name)&&(a.lastName!==e[n.name]&&(l=!1),o.lastName=e[n.name]),"phone"===v(n.name)&&(a.phoneNumber!==e[n.name]&&(l=!1),o.phoneNumber=e[n.name]),"email"===v(n.name)&&(a.email!==e[n.name]&&(l=!1),o.email=e[n.name]),"company"===v(n.name)&&(a.company!==e[n.name]&&(l=!1),o.company=e[n.name]))})),s&&t.forEach((n=>{if(n.fieldId===i&&o?.formFields){o.formFields.push({name:n?.bcLabel||"",value:e[i]}),s=!1;const t=(a?.formFields||[]).find((e=>e.name===n.bcLabel));t&&JSON.stringify(t.value)!==JSON.stringify(e[i])&&(l=!1)}})),s&&("password"===i?(o.newPassword=e[i],e[i]&&(l=!1)):o[i]=e[i]),s=!0})),!l)return o}}}}));
//# sourceMappingURL=index-legacy-DKz8enf4.js.map
